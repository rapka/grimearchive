extends layout

block content
	.upload.content 
		
			div.upload-labels
				p Title:
				p DJ: 
				p MCs:
				p Crews:
				p Radio Station / Rave:
				p Air Date:
				p Description:
			div.upload-inputs
				form(name="upload", action="/upload", method="post", enctype='multipart/form-data')
					input(type="text", name="title")
					br
					input(type="text", name="dj")
					br
					input(type="text", name="mcs")
					br
					input(type="text", name="crews")
					br
					input(type="text", name="station")
					br
					input(type="text", name="day")
					input(type="text", name="month")
					input(type="text", name="year")
					br
					textarea(name="description" cols="40" rows="5")
					br
					input(type="file", name="file" id='_file')
					input(type='submit', value='Upload', id='_submit')
			div.upload-bar
					div.progress
						| O%
					script(src='https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js')
					script(type='text/javascript').
						$('input[type="submit"]').on('click', function(evt) {
								//evt.preventDefault();
								console.log("uploading");
								$('div.progress').show();
								//var formData = new FormData();
								var file = document.getElementById('_file').files[0];

								//formData.append('_file', file);
								
								var xhr = new XMLHttpRequest();
								xhr.addEventListener("progress", progressHandler, false);
								xhr.upload.addEventListener("progress", progressHandler, false);
								xhr.open('post', '/', true);
								xhr.addEventListener("progress", progressHandler, false);
								xhr.upload.addEventListener("progress", progressHandler, false);						
								
								
								xhr.onerror = function(e) {
									//showInfo('An error occurred while submitting the form. Maybe your file is too big');
								};
								
								xhr.onload = function() {
									//showInfo(this.statusText);
								};
								
								//xhr.send(formData);
								
							});

							function progressHandler(e) {
									if (e.lengthComputable) {
										
										var percentage = (e.loaded / e.total) * 100;
										console.log(percentage + '%');
										$('progress').text(percentage + '%');
									}
								};
  
