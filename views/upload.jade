extends layout

block content
	.upload.content 
		
			div.upload-labels
				p Title:
				p DJ: 
				p MCs:
				p Crews:
				p Radio Station / Rave:
				p Air Date:
				p Description:
			div.upload-inputs
				form(name="upload", action="/upload", method="post", enctype='multipart/form-data')
					input(type="text", name="title")
					br
					input(type="text", name="dj")
					br
					input(type="text", name="mcs")
					br
					input(type="text", name="crews")
					br
					input(type="text", name="station")
					br
					input(type="text", name="day")
					input(type="text", name="month")
					input(type="text", name="year")
					br
					textarea(name="description" cols="40" rows="5")
					br
					input(type="file", name="file" id='_file')
					input(type='submit', value='Upload')
			div.upload-bar
					div.progress_outer
						#_progress.progress
					script(src='https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js')
					script(type='text/javascript').
						var _submit = $("_submit"), 
						_file = $("_file"), 
						_progress = $("_progress");
						
						var upload = function(){
						
							if(_file.files.length === 0){
								return;
							}
						
							var data = new FormData();
							data.append('SelectedFile', _file.files[0]);
						
							var request = new XMLHttpRequest();
							request.onreadystatechange = function(){
								if(request.readyState == 4){
									try {
										var resp = JSON.parse(request.response);
									} catch (e){
										var resp = {
											status: 'error',
											data: 'Unknown error occurred: [' + request.responseText + ']'
										};
									}
									console.log(resp.status + ': ' + resp.data);
								}
							};
						
							request.upload.addEventListener('progress', function(e){
							    _progress.style.width = Math.ceil(e.loaded/e.total) * 100 + '%';
							}, false);
						
							request.open('POST', 'upload.php');
							request.send(data);
						}
						
						_submit.addEventListener('click', upload);
			